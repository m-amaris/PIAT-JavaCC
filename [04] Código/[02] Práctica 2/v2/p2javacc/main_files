package piat.javacc;

import java.io.File;
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

public class Main {
    /** Main entry point. */
    public static void main(String args[]) {
        final EstUsuario eu = new EstUsuario();
        final  EstGenerales eg = new EstGenerales();

        final long tiempoComienzo = System.currentTimeMillis();


        final File[] ficheros = new File(args[0]).listFiles();
        final ExecutorService ejecutor = Executors.newFixedThreadPool(Runtime.getRuntime().availableProcessors());
        for (File f : ficheros) {
            System.out.print(".");
            try {
                final Trabajador t = new Trabajador(f,eu,eg);
                ejecutor.execute(t);
            } catch (Exception e) {
                System.out.println("\u001B[31m" + e.getMessage() + "\u001B[0m");
                e.printStackTrace();
            }
        }
        ejecutor.shutdown();
        System.out.println("\n" + "\u001B[32m" + "Files Proccessed withoud errors!" + "\u001B[0m");

        System.out.println();
        eg.mostrar();
        System.out.println();
        eu.mostrar(1);
        final long tiempoFinal = System.currentTimeMillis();
        final long tiempoTranscurrido = (long) ((tiempoFinal - tiempoComienzo) / 1000);
        System.out.println("\nTiempo de ejecuci√≥n: " + tiempoTranscurrido + " segundos");
    }



    
}
